<!DOCTYPE html>
<html>
<head>
    <title>WebEOC Shelter Status</title>
    <meta http-equiv="Content-type" content="text/html; charset=windows-1252">
    <!-- JS: Form  10/17/12 - Ver 2.0 Does not require additonal subroutine
         to pac-read.exe.
         1/11/13 -  Fixed some JS '<' as per Clark problem
         07/22/13 - Modified textarea LF flag from Inv. ? to \n for 7 bit problem
         07/22/13 - Changed trim: user '] to ''] and ] to ']; all reversed thru pac-read
         07/22/13 by HPH, added a fix to trim to add a blank to the end of the string if a
            backtick is the last character
         07/23/12 by HPH, Added command to unwrap to convert inverted ? to \n for input from old forms
         09/23/14 by HPH, No change, revised version to 4.0
         10/1/14 by HPH, change Receiving to Receiver's in "When Sending Message" msg. no, field
         10/27/14 by HPH, Fixed typo "Senders's" to "Sender's"
         01/11/15 by HPH, Fixed JS function geturl to remove problem with a slash in Outpost ID user name

     -->
    <style type="text/css">
        table {
            font-family: arial;
        }

        #button {
            font-weight: bold;
            font-size: 9pt;
            font-family: Times New Roman,Serif
        }

        .fsize0 {
            font-size: 11pt;
            font-weight: bold;
            text-align: left;
            vertical-align: bottom;
            color: black;
        }

        .fsize1 {
            font-size: 8pt;
            font-weight: bold;
            text-align: left;
            color: #084B8A;
        }

        .fsize2 {
            font-size: 9pt;
            font-weight: bold;
            text-align: left;
            vertical-align: middle;
            color: black;
        }

        .fsize2r {
            font-size: 9pt;
            font-weight: bold;
            text-align: right;
            vertical-align: middle;
            color: black;
        }

        .fsize3 {
            font-size: 9pt;
            font-weight: bold;
            text-align: left;
            vertical-align: middle;
            color: white;
        }

        .fsize4 {
            font-size: 9pt;
            font-weight: bold;
            text-align: left;
            vertical-align: top;
            color: black;
        }

        .fsize5 {
            font-size: 9pt;
            font-weight: bold;
            color: black;
        }

        .red {
            color: red;
        }

        input, select, textarea {
            background: #ffffbb
        }

        .msgno {
            font-family: arial;
            font-size: 9pt;
            color: black;
            text-align: right;
        }

        .reply {
            background-color: yellow;
            display: none;
        }

        .table2 {
            font-weight: bold;
            font-size: 8pt;
            font-family: Arial;
        }

        .title-text {
            font-size: 12pt;
            font-weight: bold;
            color: blue;
        }

        .s2-title-text {
            font-size: 9pt;
            font-weight: normal;
        }

        .js-error-text {
            font-size: 12pt;
            font-weight: bold;
            color: red;
        }

        .banner-table {
            background: #DDDDDD;
        }

        .js-head-text {
            font-size: 9pt;
            font-weight: bold;
        }

        .form-ver-text {
            font-size: 8pt;
            font-weight: bold;
            text-decoration: underline;
        }
    </style>
    <style type="text/css" media="print">
        .header, .trailer {
            display: none;
        }
    </style>

    <style type="text/css" media="print">
        .header, .trailer {
            display: none;
        }

        .red {
            color: black;
        }

        hr {
            color: black
        }

        input, select, textarea {
            color: black;
            background: none;
        }

        .title-text {
            color: black;
        }
    </style>

    <script language="JavaScript">
        // <!--

        var JSid = "WebEOC Shelter Status - PACFORM Author:Phil Henderson (which4)";
        var JSver = "JS-ver. PR-4.4-3.0, 08-22-18";
        var JShead = "<span class=\"js-head-text\">JavaScript Version PR-4.4-3.0 for Amateur Radio Packet Transmission, 08/22/18 - <b>PacRELEASE 4.4</b></span>";
        //var JStail = "(PR-4.4-3.10, 08/22/18)";
        var JStail = "SCCo OA Shelter Status Version 20180821 (PR-4.4-3.0, 08/22/18)";
        var JSTopHead = "County of Santa Clara Emergency Operations Center<br>SCC OA SHELTER STATUS";

        fromlocal = 0;  // =0 for call to pac-read with No !OUTPOST! record; >0 if so. Reset fm pac-read.

        function lockUnlockMsg(checkbox) {
            if (checkbox.checked === 1) {
                document.getElementById('RSmsgno').disabled = false;
                document.getElementById('SRmsgno').disabled = false;
            }
            else {
                document.getElementById('RSmsgno').disabled = true;
                document.getElementById('SRmsgno').disabled = true;
            }
        }

        function emerg() {
        document.forms[0].handling[0].checked = true;
        }

        var whichway, ascii, thisurl;
        thisurl = "";
        function geturl() {
            if (thisurl !== "") { return thisurl; }
            var res = new Array(), tem = new Array();
            var a = document.URL;
            tem = a.split(/\?/);
            //  alert(a+", T0:"+tem[0]+", T1:"+tem[1]);
            a = tem[0];
            a = a.replace(/\\/g, "\/");
            res = a.split(/\//g);
            var l = res.length - 1;
            //  alert(a+", "+l+", "+res[0]+","+res[l]);
            return res[l];
        }


        function resetforms() {
        document.forms[0].reset();
            document.forms[1].reset();
            datetime(0);  // added 4/17/10
        }

        function hide_message() {
            document.getElementById('errormessage1').style.display = 'none';
        }

        function Browser() {
            var bb = navigator.appName;
            if (bb.indexOf("Microsoft") !== -1) {
                return true;
            }
            else {
                return false;
            }
        }

        function zerofill(val) {
            if (val > 9) { return "" + val }
            return "0" + val;
        }

        function datetime(dum1)  // Parameter added 1/11/11 to update Operator send date/time
        {
            var hr, ampm;
            var Today = new Date();
            var month = zerofill(Today.getMonth() + 1);
            var year = Today.getFullYear();
            var day = zerofill(Today.getDate());
            var hr1 = Today.getHours();
            var min = zerofill(Today.getMinutes());
            var sec = zerofill(Today.getSeconds());
            /*
                     if (hr1 >12)
                      { hr = hr1 - 12;
                        ampm = " PM";
                      } else
                      { hr = hr1;
                        ampm = " AM";
                      }
            */
            hr1 = zerofill(hr1);
            var dat = month + "/" + day + "/" + year;
            var tim = hr1 + ":" + min;
            if (dum1 === 0) {
                document.forms[0].Date.value = dat;
                document.forms[0].Time.value = tim;
                document.forms[0].odate.value = dat;
                document.forms[0].otime.value = tim;
            } else
                if (dum1 === 1) {
                document.forms[0].odate.value = dat;
                    document.forms[0].otime.value = tim;
                    document.forms[0].ordate.value = dat;
                    document.forms[0].ortime.value = tim;
                } else
                    if (dum1 === 2) {
                    document.forms[0].odate.value = "";
                        document.forms[0].otime.value = "";
                        document.forms[0].ordate.value = "";
                        document.forms[0].ortime.value = "";
                    }
        }

        function trim(strval)              // Trims leading and trailing blanks
        {
            strval = strval.replace(/\`\]/g, "\x87")  // New - temp.
            strval = strval.replace(/\]/g, "`]");     // New
            strval = strval.replace(/\x87/g, "``]");  // New
            strval = strval.replace(/\s*$/, "");
            strval = strval.replace(/^\s*/, "");
            strval = strval.replace(/\`$/, "` ");  // adds a last backtick with backtick blank
            return strval;
        }

        function wrap(inStr, cols) {
            var i, n, itot, str, res, cvt;
            words = new Array;
            if (inStr === "") { return inStr; }
            if (cols < 0) {
                cols = Math.abs(cols);
                //       inStr = inStr.replace(/%BF/g, "%37BF");  // removes %BF typed by user NEW
                //       inStr = inStr.replace(/\n/g,"\xBF");   // Inverted ?
                inStr = inStr.replace(/\n/g, "\\n");      //NEW
                inStr = inStr.replace(/\r/g, "");
                //       inStr = "\xBF"+inStr;                  // Inverted ?
                inStr = "\\n" + inStr;                    // NEW
            } else {
                inStr = inStr.replace(/\n|\r/g, " ");
            }
            words = inStr.split(" ");
            iwd = words.length;
            n = inStr.length;
            i = 0;
            k = 0;
            res = "";
            blk = "";
            itot = 0;
            for (i = 0; i < iwd; i++) {
                if (itot >= cols) {
                words[i] = words[i] + "\n";
                    itot = 0;
                }
                itot = itot + words[i].length + 1;
                res = res + blk + words[i];
                blk = " ";
            }
            return res;
        }

        var itot;
        function unwrap(str, msg) {
            var i, n, nl, iwd, k;
            words = new Array;
            icols = msg.cols;
            irows = msg.rows;
            str = str.replace(/\xBF/g, "\\n");  // Converts all inverted ? to \n from old versions, 7/23/13
            str = str.replace(/\\n/g, "\n");
            //      str = str.replace(/%37/g, "%");     // NEW
            if (str.charAt(0) === "\n")      // Removes inverted \n at 1st Chr.
            { str = str.substring(1); }
            parl = countlines(str);
            tsl = str.length;
            nrows = Math.ceil(tsl / icols);
            words = str.split(" ");
            iwd = words.length;
            n = str.length;
            //    if (n <= icols) { return inStr }
            i = 0;
            k = 0;
            nl = 0;
            res = "";
            itot = 0;
            for (i = 0; i < iwd; i++) {
                if (itot >= icols) {
                    nl++;
                    itot = 0;
                }
                itot = itot + words[i].length + 1;
            }
            itot = nl + parl + 1;
            if (nrows > itot) { itot = nrows; }
            //  alert(nl+" "+parl+" "+irows+" "+icols+" "+nrows )
            str = str.replace(/\n/g, "\r\n");
            if (itot > irows) { msg.rows = itot; }
            return str;
        }

        function countlines(inStr) {
            var i, n, m;
            n = 0;
            i = 0;
            m = inStr.indexOf("\n", n);
            while (m >= 0) {
                i++;
                n = m + 1;
                m = inStr.indexOf("\n", n);
            }
            return i;
        }

        sepChar = String.fromCharCode(167);
        instr = "";

        function out(win, text, param) {
            var str, val, str1;
            if (param === "") { return; }
            str = text + ": [" + param + "]\n";
            //  str1 = text+":["+param+"]";
            if (whichway === 0) {
                win.document.write(str);
            } else {
                ascii += str;
            }
        }

        function radio(win, param, text) {
            var i, val, j, max;
            max = param.length;
            j = 0;
            for (i = 0; i < max; i++) {
                if (param[i].checked) {
                    val = param[i].value;
                    out(win, text, val);
                    j = 1;
                }
            }
            if (j === 0) { out(win, text, "") }
        }

        function fradio(param) {
            var i, val, j, max;
            max = param.length;
            j = 0;
            for (i = 0; i < max; i++) {
                if (param[i].checked) {
                    val = param[i].value;
                    j = 1;
                }
            }
            if (j === 0) { val = ""; }
            return val;
        }

        function fdropdown(param) {
            var indx, val;
            indx = param.selectedIndex;
            val = param.options[indx].value;
            return val;
        }

        function testvalues() {
            var str;
            str = "";
            if (Fmsgno === "") { str = "Enter a Message Number."; }
            if (Fsever === "") { str = str + "\n Indicate Situation Severity."; }
            if (Fhandling === "") { str = str + "\n Indicate Msg. Handling Order."; }
            if (Fincident === "") { str = str + "\n Enter an Incident."; }
            if (Fcitylist === "0") { str = str + "\n Select your Municipality."; }
            //    if (Fcitylist =="Other" && Fother =="")
            //        { str=str+"\n Enter a value for Other."; }
            if (str === "") {
                return true;
            } else {
                datetime(2);
                alert(str);
                return false;
            }
        }

        function checkbox(param) {
            if (param) {
                return "checked";
            } else {
                return "";
            }
        }

        function gatherdata() {
            document.forms[1].formtext.value = ascii;
            return;
        }

        function poundstuff() {
            var reqStr = "!PACF! " + pacf + "\n" + "# JS:" + JSid + "\n" + "# " + JSver + "\n" +
                "# FORMFILENAME: " + geturl() + "\n";
            //   "# Form Item numbers are followed by a colon (:)\n"+
            //   "# Answers are enclosed in brackets ( [ ] )\n"+
            //   "# Note: The symbol "+"\xBF"+" is NOT a bug. It is used in Textarea formatting.\n";
            return reqStr;
        }

        var pacf = "";
        function newwin(theway) {
            datetime(1);
            whichway = theway;

            // Required form fields are defined here and are tested in testvalues
            // variable to the left of = is the same as the form field name with Fadded at the beginning.
            Fcitylist = fdropdown(document.forms[0].citylist);
            // Fother = trim(document.forms[0].other.value);
            Fmsgno = trim(document.forms[0].msgno.value); // TEXT
            Fsever = fradio(document.forms[0].sever);
            Fhandling = fradio(document.forms[0].handling);
            Fincident = trim(document.forms[0].incident.value);
            // End of list of Required Form fields

            // Next 5 lines are for added info after !PACF!
            d = "JS:WebEOC-Muni-Status";
            a = Fmsgno.substring(0);
            b = Fsever.substring(0, 1);
            c = Fhandling.substring(0, 1);
            pacf = a + "_" + b + "/" + c + "_" + d + "_" + Fincident;
            //
            if (whichway === 1) {
                ascii = poundstuff();
                NewWin = 0;
            } else {
                if (!testvalues()) { return; }

                NewWin = window.open("", null, "height=600,width=700,status=yes,toolbar=yes,menubar=yes,location=no,scrollbars=yes,resizable=yes");
                // NewWin.document.write("Content-type: text/plain");
                NewWin.document.write("<" + "html>");
                NewWin.document.write("<" + "head>\n");
                NewWin.document.write("<title>WebEOC Shelter Status</title>\n");
                var bbb = Browser();
                if (bbb) {
                    NewWin.document.write('<SCRIPT LANGUAGE="JavaScript" type="text/javascript">\n');

                    NewWin.document.write("function ClipBoard()\n");
                    NewWin.document.write(" { \n");
                    NewWin.document.write("   holdtext.innerText = copytext.innerText; \n");
                    NewWin.document.write("   Copied = holdtext.createTextRange(); \n");
                    NewWin.document.write("   Copied.execCommand(\"Copy\"); \n");
                    NewWin.document.write(" } \n");

                    NewWin.document.write("<//SCRIPT> \n");
                }
                NewWin.document.write("</head> \n");
                if (bbb) {
                    NewWin.document.write('<' + 'body  bgcolor="#ffffff" onLoad="ClipBoard()">\n');
                    NewWin.document.write("<SPAN ID=\"copytext\" STYLE=\"background-color:lightblue\">\n");
                    NewWin.document.write("<TEXTAREA ID=\"holdtext\" STYLE=\"display:none;\"> </TEXTAREA>\n");
                }
                else {
                    NewWin.document.write('<' + 'body>\n');
                }
                NewWin.document.write("<pre>\n");
                NewWin.document.write("!PACF! " + pacf + "\n# JS:" + JSid + "\n");
                NewWin.document.write("# " + JSver + "\n");
                NewWin.document.write("# FORMFILENAME: " + geturl() + "\n");
                /*
                if (bbb)
                 { NewWin.document.write("<font color="red"># \n");
                   NewWin.document.write("# THE LIGHT BLUE HIGHLIGHTED TEXT HAS BEEN AUTOMATICALLY COPIED \n");
                   NewWin.document.write("# to the Clipboard.  To save it to a file, you must \n");
                 }
                else
                 { NewWin.document.write('<font color="red"># TO COPY THE TEXT IN THIS WINDOW, FOCUS THIS WINDOW, THEN:\n');
                   NewWin.document.write("# Select All ASCII Text by typing Ctrl-A, then Ctrl-C to Copy.\n");
                 }
                NewWin.document.write("# Next, RUN WordPad or Notepad and DO Ctrl-V to Paste into the editor body.\n");
                NewWin.document.write("# Then DO Save-As to a TEXT Document file, or Paste directly into Outpost.</font>\n");
                NewWin.document.write("# Form Item numbers are followed by a colon (:)\n");
                NewWin.document.write("# Answers are enclosed in brackets ( [ ] )\n");
                NewWin.document.write("# Note: The symbol "+"\xBF"+" is NOT a bug. It is used in Textarea formatting.\n");
                */
            }  // end of else loop where whichway == 0
            //
            listels();

            if (whichway === 0) {
                NewWin.document.write("#EOF\n");
            } else {
                ascii += "#EOF\n";
                gatherdata();
                return;
            }
            //
            NewWin.document.write("</pre>\n");
            if (bbb) { NewWin.document.write("</SPAN>"); }
            NewWin.document.write("</body>");
            NewWin.document.write("</html>");
            NewWin.document.close();
        }

        //
        var qsParm = new Array();
        var qsVal = new Array();
        var qsN;
        function qs() {
            var n = 0;
            var query = window.location.search.substring(1);
            query = query.replace(/%20/g, "");
            var leng = query.length;
            // alert("Query="+query+", "+leng);
            if (leng <= 1) { return; }
            var parms = query.split('&');
            qsN = parms.length;
            for (var i = 0; i < qsN; i++) {
                var pos = parms[i].indexOf('=');
                if (pos > 0) {
                    qsParm[i] = parms[i].substring(0, pos);
                    qsVal[i] = parms[i].substring(pos + 1);
                    qsVal[i] = decodeURI(qsVal[i]);
                    qsVal[i] = qsVal[i].replace(/\+/g, " ");
                }
            }
            assignq();
        }

        function assignq() {
            var i, j, dum;
            for (i = 0; i < qsN; i++) {
                if (!document.forms[0][qsParm[i]]) {
                    alert(">>> Form Field name \'" + qsParm[i] + "\' does NOT exist.");
                } else {
                document.forms[0][qsParm[i]].value = qsVal[i];
                }
            }
        }

        function available() {
            var a, b;
            a = document.forms[0].Capacity.value - 0;
            b = document.forms[0].Occupancy.value - 0;
            document.forms[0].Available.value = a - b;
            if (b > a) {
                alert("NOTE: Occupancy is GREATER THAN Capacity!");
            }
        }

        function custom() {
            var num;
            qs(); // Do Not remove this function call. Used by Outpost to pass data.
            num = document.forms[0].msgno.value;
            if (num === "$$") { writeels(); }
            //    writeels(); // Uncomment when you want to check all elements
        } //End Custom
        //

        function testreply() {
            if (fromlocal > 0) {
                document.getElementById("senddt").style.display = "none";
                document.getElementById("outpostdt").style.display = "block";
            }
            return;
        }

        function writeels() {
            var n, typ, val, nam, str, lb;
            n = document.forms[0].elements.length;
            EleWin = window.open("", null, "height=600,width=700,status=yes,toolbar=yes,menubar=yes,location=no,scrollbars=yes,resizable=yes");
            EleWin.document.write("<html>\n<head>\n<title>Element List</title>\n</head>\n");
            EleWin.document.write("<body>\n<b>ELEMENT LIST for " + geturl() + "<p>Ele. Index, Type, Name, Value</b><p>");
            for (i = 0; i < n; i++) { // lb = String.fromCharCode(163); // English pound sign - to flag select index
                lb = "}"; // Single right brace to flag index
                typ = document.forms[0].elements[i].type;
                nam = document.forms[0].elements[i].name;
                val = document.forms[0].elements[i].value;
                str = i + ", " + typ + ", &nbsp; " + nam + ",  &nbsp; " + val + ", &nbsp; ";
                if (typ === "radio" || typ === "checkbox") {
                    chk = document.forms[0].elements[i].checked;
                    str = str + "[" + chk + "], ";
                }
                if (typ === "select-one") {
                    indx = document.forms[0].elements[i].selectedIndex;
                    str = str + lb + indx;
                }
                str = str + ",<br>";
                EleWin.document.write(str);
            }
            EleWin.document.write("</body>\n</html>\n");
            EleWin.document.close();
        }

        var inl = new Array();
        var inr = new Array();

        function outels() {
            var inn, typ, val, indx, nam, chk, nidx, k, lb;
            var dum = new Array();
            // lb= String.fromCharCode(163);
            lb = "}";
            inn = inl.length;
            // alert(inn+" "+inl[0]+" "+ inl[1]);
            for (i = 0; i < inn; i++) {
                k = inl[i];
                typ = document.forms[0].elements[k].type;
                nam = document.forms[0].elements[k].name;
                if (typ === "radio" || typ === "checkbox") {
                    document.forms[0].elements[k].checked = inr[i];
                } else if (typ === "text" || typ === "hidden") {
                    document.forms[0].elements[k].value = inr[i];
                } else if (typ === "textarea") {
                    ms2 = unwrap(inr[i], document.forms[0].elements[k]);
                    document.forms[0].elements[k].value = ms2;
                } else if (typ === "select-one") {
                    dum = inr[i].split(lb);
                    indx = dum[1];
                    document.forms[0].elements[k].selectedIndex = indx;
                }
            }
            testreply();
        }

        function listels() {
            var n, typ, val, indx, nam, chk, nidx, k, lb;
            n = document.forms[0].elements.length;
            //  lb = String.fromCharCode(163); // English pound sign - to flag select index
            //  yen = String.fromCharCode(165); // Yen sign to flag odate or otime parameter
            lb = "}";
            yen = "{";
            for (i = 0; i < n; i++) {
                typ = document.forms[0].elements[i].type;
                nam = document.forms[0].elements[i].name;
                if (typ === "radio" || typ === "checkbox") {
                    chk = document.forms[0].elements[i].checked;
                    out(NewWin, i, chk);
                    //            test=chk+" "+typ+" "+nam;
                    //            out(NewWin,i,test);
                } else {
                    val = document.forms[0].elements[i].value;
                    if (typ === "text" || typ === "textarea" || typ === "hidden") {
                        val = trim(val);
                        if (nam === "odate" || nam === "otime" || nam === "ocall" || nam === "oname") {
                            val = val + yen + nam;
                        }
                    }
                    if (typ === "textarea") {
                        val = wrap(val, -50);
                    }
                    if (typ === "select-one") {
                        indx = document.forms[0].elements[i].selectedIndex;
                        val = val + lb + indx;
                    }
                    out(NewWin, i, val);
                }
            }
            if (document.forms[0].msgno.value === "$$") { writeels(); }
        }

        // -->
    </script>
    <script src="js/AddedForWebView.js"></script>
    <!-- PART1 -->
</head>
<body bgcolor="#ffffff" onLoad="hide_message(); datetime(0); custom();">
<!-- PART2 -->

    <center>
        <table class="banner-table" width="75%">
            <tbody>
                <tr>
                    <td>
                        <center>
                            <span class="title-text">
                                <script language="JavaScript">
                                    // put in header area
                                    document.write(JSTopHead);
                                </script>
                            </span>
                            <div class="js-head-text header">
                                <script language="JavaScript">
                                    // put in header area
                                    document.write(JShead);
                                </script><br>
                                <span class="s2-title-text">(For the manual saving of the ASCII output, this form is best used with Microsoft Internet Explorer)</span>
                                <div id="errormessage1" name="errormessage1" align="center">
                                    <p>&nbsp;</p>
                                    <hr size="3" color="red">
                                    <span class="js-error-text">
                                        JAVASCRIPT IS NOT ENABLED IN THIS BROWSER.<br>
                                        THIS FORM WILL NOT WORK WITHOUT JAVASCRIPT ENABLED.
                                    </span>
                                    <hr size="3" color="red">
                                    <p>&nbsp;</p>
                                </div>
                            </div>
                        </center>
                    </td>
                </tr>
            </tbody>
        </table>

        <!-- PART3 -->

        <form name="Form1">
            <table border="2" width="65%">
                <tr>
                    <td>
                        <center>
                            <span class="red header">
                                Items in RED are required
                            </span><br>

                            <table class="msgno">
                                <tr>
                                    <td>
                                        <b>A.) When Receiving Msg.,<br>Sender's Msg. No.</b>
                                    </td>
                                    <td>
                                        <input type="text" size="8" name="RSmsgno" tabindex=1 id="RSmsgno" disabled="true">
                                    </td>
                                    <td align="center">
                                        <span class="red">
                                            <b> &nbsp; &nbsp; &nbsp; B.) Msg. Number </b><input type="text" size="10" name="msgno" tabindex=2>
                                        </span><b> &nbsp; &nbsp; &nbsp; </b>
                                        <br /> <span style="font-size:8pt">
                                            <input type="checkbox" name="unlockmsg1" value="1" onclick="lockUnlockMsg(this)">
                                            Unlock msg. nos. A) &amp; C)
                                        </span>
                                    </td>
                                    <td>
                                        <b>C.) When Sending Msg.,<br>Receiver's Msg. No.</b>
                                    </td>
                                    <td>
                                        <input type="text" size="8" name="SRmsgno" tabindex=3 id="SRmsgno" disabled="true">
                                    </td>
                            </table>

                            <table border="1" class="table2">
                                <tr>
                                    <td align="left">
                                        <span class="red">
                                            <b>&nbsp;D.) Situation Severity
                                        </span><span class="header">(Select One)</span><br>
                                        <input type="radio" name="sever" value="EMERGENCY" tabindex=6 onClick="emerg()">
                                        EMERGENCY</b><span class="header">&nbsp; (e.g., Life Threat)</span><br>
                                        <input type="radio" name="sever" value="URGENT" tabindex=7>
                                        <b>URGENT</b><span class="header">&nbsp; (e.g., Property Threat)</span><br>

                                        <input type="radio" name="sever" value="OTHER" tabindex=8>
                                        <b>OTHER</b><span class="header">&nbsp; (All Others)</span><br>
                                    </td>

                                    <td align="left">
                                        <span class="red">
                                            <b>&nbsp;E.) Msg. Handling Order
                                        </span><span class="header">(Select One)</span></b><br>
                                        &nbsp; <input type="radio" name="handling" value="IMMEDIATE" tabindex=9><b> IMMEDIATE</b>
                                        <span class="header">&nbsp; (As Soon as Possible)</span><br>
                                        &nbsp; <input type="radio" name="handling" value="PRIORITY" tabindex=10><b> PRIORITY</b>
                                        <span class="header">&nbsp; (Less Than One Hour)</span><br>
                                        &nbsp; <input type="radio" name="handling" value="ROUTINE" tabindex=11><b> ROUTINE</b>
                                        <span class="header">&nbsp; (More Than One Hour)</span><br>
                                    </td>

                                    <td align="left">
                                        <b>
                                            &nbsp;F.) Message Requests You to:<br>
                                            &nbsp; &nbsp; &nbsp; REPLY
                                        </b> (Check one)<br>

                                        <input type="radio" name="replyyn" value="Yes" tabindex=14><b>
                                            Yes, by
                                            <input type="text" name="replyby" size="12" tabindex=15>&nbsp;
                                            <input type="radio" name="replyyn" value="No" tabindex=16>No<br>
                                    </td>
                                </tr>
                            </table>

                            <hr>

                            <!--  END Header, Start Form Body -->

                            <table border="0" align="left">
                                <tr>
                                    <td align="left">
                                        <font face="arial" color="black" size="5">
                                            <b>Shelter Status</b><br>
                                        </font><span class="red">
                                            <font face="arial" size="3">
                                                <b>Incident: </b><input type="text" name="incident" size="35"></b>
                                            </font>
                                        </span>
                                        &nbsp; &nbsp; &nbsp; &nbsp; <span class="fsize5">
                                            Date &nbsp;
                                            <input type="text" name="Date" size="15" value="mm/dd/yyyy"> &nbsp; &nbsp;
                                            Time (24 hr time)
                                            <input type="text" name="Time" size="7" value="hh:mm">
                                        </span>
                                        <p><hr><p>
                                            <span class="red">
                                                <font face="arial" size="2">
                                                    <b>
                                                        Municipality Name / Unincorporated:
                                                    </b>
                                                </font>
                                            </span>
                                            <select name="citylist">
                                                <option value="0">SELECT the Municipality</option>
                                                <option value="County">County</option>
                                                <option value="Campbell">Campbell</option>
                                                <option value="Cupertino">Cupertino</option>
                                                <option value="Gilroy">Gilroy</option>
                                                <option value="Loma Prieta">Loma Prieta</option>
                                                <option value="Los Altos">Los Altos</option>
                                                <option value="Los Altos Hills">Los Altos Hills</option>
                                                <option value="Los Gatos/Monte Sereno">Los Gatos/Monte Sereno</option>
                                                <option value="Milpitas">Milpitas</option>
                                                <option value="Morgan Hill">Morgan Hill</option>
                                                <option value="Mountain View">Mountain View</option>
                                                <option value="NASA-Ames">NASA-Ames</option>
                                                <option value="Palo Alto">Palo Alto</option>
                                                <option value="San Jose">San Jose</option>
                                                <option value="Santa Clara">Santa Clara</option>
                                                <option value="Saratoga">Saratoga</option>
                                                <option value="Stanford">Stanford</option>
                                                <option value="Sunnyvale">Sunnyvale</option>
                                                <option value="Unincorporated">Unincorporated</option>
                                            </select>
                                            <!--
                                        &nbsp; &nbsp; &nbsp; &nbsp; </font><font face="arial" color="black" size="2">
                                         If <b>Other</b> Enter Name:
                                        <input type="text" name="other" size="25">
                                        </font>
                                        -->
                                    </td>
                                </tr>
                            </table>
                            <p>
                                <table border="0" align="left">
                                    <caption align="top" class="fsize0"><hr><u>Shelter</u></caption>
                                    <tr>
                                        <td class="fsize2r">
                                            &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                                            &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; Shelter Type: &nbsp;
                                        </td>
                                        <td>
                                            <select name="ShelterType">
                                                <option value="Type 1">Type 1</option>
                                                <option value="Type 2">Type 2</option>
                                                <option value="Type 3">Type 3</option>
                                                <option value="Type 4">Type 4</option>
                                            </select>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="fsize2r"> &nbsp; Shelter Status:&nbsp;</td>
                                        <td>
                                            <select name="ShelterStat">
                                                <option value="Closed">Closed</option>
                                                <option value="Full">Full</option>
                                                <option value="Open">Open</option>
                                            </select>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="fsize2r">Name: &nbsp;</td>
                                        <td>
                                            <input type="text" name="ShelterName" size="50">
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="fsize2r">Address: &nbsp;</td>
                                        <td>
                                            <input type="text" name="ShelterAddress" size="50">
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="fsize2r">Latitude: &nbsp;</td>
                                        <td class="fsize2">
                                            <input type="text" name="Latitude" size="12"> &nbsp; &nbsp;
                                            &nbsp; Longitude: <input type="text" name="Longitude" size="12">
                                        </td>
                                    </tr>
                                </table>

                            <p>&nbsp;<p>
                                <table border="0" align="left">
                                    <caption align="top" class="fsize0"><hr><u>Shelter Information</u><br></caption>
                                    <tr>
                                        <td class="fsize2r">Capacity: &nbsp;</td>
                                        <td class="fsize2"><input type="text" name="Capacity" size="6" onChange="available()"></td>
                                    </tr>
                                    <tr>
                                        <td class="fsize2r">Occupancy: &nbsp;</td>
                                        <td class="fsize2"><input type="text" name="Occupancy" size="6" onChange="available()"></td>
                                    </tr>
                                    <tr>
                                        <td class="fsize2r">Availability: &nbsp;</td>
                                        <td class="fsize2">
                                            <input type="text" name="Available" size="6" value="0">
                                            &nbsp; (Automatically computed)
                                        </td>
                                    </tr>
                                    <tr>
                                        <td class="fsize2r">Meals Served (last 24 hours): &nbsp;</td>
                                        <td class="fsize2"><input type="text" name="Meals" size="6"></td>
                                    </tr>
                                    <tr>
                                        <td class="fsize2r">NSS Number: &nbsp;</td>
                                        <td class="fsize2"><input type="text" name="NSSNum" size="20"></td>
                                    </tr>
                                    <tr>
                                        <td class="fsize2r">Pet Friendly: &nbsp;</td>
                                        <td class="fsize2"><input type="checkbox" name="Pet"></td>
                                    </tr>
                                    <tr>
                                        <td class="fsize2r">Basic Safety Inspection: &nbsp;</td>
                                        <td class="fsize2"><input type="checkbox" name="SafetyInspec"></td>
                                    </tr>
                                    <tr>
                                        <td class="fsize2r">ATC 20 inspection: &nbsp;</td>
                                        <td class="fsize2"><input type="checkbox" name="ATCInspec"></td>
                                    </tr>
                                    <tr>
                                        <td class="fsize2r">Available Services: &nbsp;</td>
                                        <td class="fsize2"><textarea name="AvailServices" cols="50" rows="3"></textarea></td>
                                    </tr>
                                    <tr>
                                        <td class="fsize2r">MOU: &nbsp;</td>
                                        <td class="fsize2"><input type="text" name="Mou" size="40"></td>
                                    </tr>
                                    <tr>
                                        <td class="fsize2r">Floor Plan: &nbsp;</td>
                                        <td class="fsize2"><input type="text" name="FloorPlan" size="50"></td>
                                    </tr>

                                </table>

                            <p>
                                <table border="0" align="left">
                                    <caption align="top" class="fsize0"><hr><u>Contact Information</u><br></caption>
                                    <tr>
                                        <td class="fsize2r">Managed By: &nbsp;</td>
                                        <td class="fsize2">
                                            <select name="ManagedByt">
                                                <option value="American Red Cross">American Red Cross</option>
                                                <option value="Private">Private</option>
                                                <option value="Community">Community</option>
                                                <option value="Government">Government</option>
                                                <option value="Other">Other</option>
                                            </select>
                                        </td>
                                    </tr>

                                    <tr>
                                        <td class="fsize2r">
                                            &nbsp;
                                            Managed By Detail: &nbsp;
                                        </td>
                                        <td class="fsize2"><input type="text" name="ByDetail" size="40"></td>
                                    </tr>

                                    <tr>
                                        <td class="fsize2r">Preimary Contact: &nbsp;</td>
                                        <td class="fsize2"><input type="text" name="PrimeCt" size="40"></td>
                                    </tr>

                                    <tr>
                                        <td class="fsize2r">Primary Phone: &nbsp;</td>
                                        <td class="fsize2"><input type="text" name="PrimePhn" size="15" value="000-000-0000"></td>
                                    </tr>

                                    <tr>
                                        <td class="fsize2r">Secondary Contact: &nbsp;</td>
                                        <td class="fsize2"><input type="text" name="SecCt" size="40"></td>
                                    </tr>

                                    <tr>
                                        <td class="fsize2r">Secondary Phone: &nbsp;</td>
                                        <td class="fsize2"><input type="text" name="SecPhn" size="15" value="000-000-0000"></td>
                                    </tr>

                                    <tr>

                                        <td colspan="2"><hr><b><u>Amateur Radio Contact Information</u></b></td>
                                    </tr>

                                    <tr>
                                        <td class="fsize2r">Tactical Call Sign:: &nbsp;</td>
                                        <td class="fsize2"><input type="text" name="TactCS" size="20"></td>
                                    </tr>

                                    <tr>
                                        <td class="fsize2r">Repeater Call Sign: &nbsp;</td>
                                        <td class="fsize2"><input type="text" name="RptCS" size="20"></td>
                                    </tr>

                                    <tr>
                                        <td class="fsize2r">Repeater Input: &nbsp;</td>
                                        <td class="fsize2"><input type="text" name="RptInput" size="20"></td>
                                    </tr>

                                    <tr>
                                        <td class="fsize2r">Repeater Output: &nbsp;</td>
                                        <td class="fsize2"><input type="text" name="RptOutput" size="20"></td>
                                    </tr>

                                    <tr>
                                        <td class="fsize2r">Offset: &nbsp;</td>
                                        <td class="fsize2"><input type="text" name="Offset" size="20"></td>
                                    </tr>

                                    <tr>
                                        <td class="fsize0" colspan="2"><hr><u>Comments</u><br></td>
                                    </tr>
                                    <tr>
                                        <td colspan="2">
                                            &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                                            <textarea name="DebrisCom" cols="60" rows="3">Enter Comments Here</textarea>
                                        </td>
                                    </tr>
                                </table>

                    </td>
                </tr>
            </table>

            <table border="1" class="table2">
                <tr>
                    <td valign="top">
                        <input type="radio" name="recsent" value="Received">Rec'd &nbsp;
                        <input type="radio" name="recsent" value="Sent" checked>Sent&nbsp;
                    </td>
                    <td>
                        <input type="radio" name="method" value="Voice">Voice &nbsp;
                        <input type="radio" name="method" value="Packet" checked>Packet&nbsp;
                    </td>
                    <td>
                        &nbsp;Call<input type="text" name="ocall" size="5"> &nbsp; &nbsp;
                        Name<input type="text" name="oname" size="20">
                    </td>
                    <td>
                        <span id="senddt" style="display:block;">
                            &nbsp;Submit Date: <input type="text" name="odate" size="9" disabled> &nbsp;
                            Time: <input type="text" name="otime" size="4" disabled> &nbsp;
                        </span>
                        <span id="outpostdt" style="display:none;">
                            Rec'd Date: <input type="text" name="ordate" size="9" disabled> &nbsp;
                            Time: <input type="text" name="ortime" size="4" disabled>
                        </span>
                    </td>
                </tr>
            </table>
            <p>
                <div class="form-ver-text" align="right">
                    <script type="text/javascript">
                        document.write(JStail);
                    </script>
                </div>
        </form>
        <center>
            <hr width="70%">

            <!-- PART3.1 -->
            <!--  Addition for saving to Outpost -->
            <div class="trailer">
                <form name="submitmachine" method="post" action="http://localhost:9334/send" onSubmit="return testvalues()">

                    <table width="75%">
                        <tr>
                            <td>
                                <font face="arial" color="red">

                                    Below you will see two SUBMIT buttons.  The one on the left, when Submitted, will
                                    open a new window with the ASCII text so you can manually capture, copy, paste and
                                    save the text.  Follow instructions in red in that window.
                                    <p>
                                        The SUBMIT button to the right will automatically transfer the ASCII text extracted
                                        from the form to the Outpost database via via OpDirect.
                                        OpDirect must be running to make this work or nothing is saved.

                                    </p>
                                </font>
                            </td>
                        </tr>
                    </table>

                    <hr width="70%">
                    <INPUT TYPE="button" VALUE="SUBMIT the Form: Manual Copy & Save" onClick="newwin(0)">
                    <INPUT TYPE="hidden" NAME=formtext VALUE=snafutextnotchanged>
                    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                    <!--<input type="SUBMIT" value="SUBMIT the Form to Outpost" onClick="newwin(1)">-->
                    <input value="SUBMIT the Form to Outpost" onclick="SubmitForm()" type="button">
                    &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                    <INPUT TYPE="RESET" VALUE="Clear Input" onClick="resetforms();">
                </form>
            </div>
        </center>
    </center>
<!--
</td></tr>
</table>
-->
</center>
</body>
</html>
<!-- PART4 -->
