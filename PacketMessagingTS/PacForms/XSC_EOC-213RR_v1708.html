<!DOCTYPE html>
<html><head>
    <title>EOC Resource Request  Form (EOC FORM 213RR)</title>
    <meta http-equiv="Content-type" content="text/html; charset=windows-1252">
    <!--
    EOCResourceRequest.html - JS: format. Form developed from the SCCo EOC Resource Request
      Form (EOC Form 213RR) by Phil Henderson, KF6ZSQ

      03/07/17 by HPH - Initiated form from Acrobat version obtained from Michael Fox
      03/08/17 by HPH - Added Second page - No form fields in this page. Added button
                        to hide or unhide second page.  Second page appears when form
                        is launched.  If hidden, then submitted, page 2 will appear
                        when printed even if it was hidden upon submitting.
                        Added "required" fields, guessing which should be required.
      03/09/17 by HPH - Made some form field size changes.  Added 3 text fields
                        for 5. Tracking Number.  Waiting from County to
                        clarify required fields and if the format for 5. is correct.
                        Added class="nowrap" to radio button areas.
      03/11/17 by HPH - Changed word from Logistics to Resource on footer.
      04/04/17 by HPH - Changed subject line ID to EOC213RR..., and modifid second page so that
                        it does NOT display on startup, but will upon print.
      04/26/17 by MEF - Changed font and field sizes for APL compatibility, consistency with other forms
                        Fixed numerous HTML errors (missing closing tags, etc.)
                        Added color section banners on page 2 to match original form
                        Added missing signature in field 22
      04/27/17 by MEF - Set "Display/Hide Page 2" button to not display in printout
      04/29/17 by MEF - Fix typo in How to use instructions.
      05/21/17 by HPH - Add missing textarea for 9.
      05/23/17 by HPH - Fixed text area name for 11. from Tarea9 to Tarea11.
      06-16-17 by HPH - Modified verson to PacRELEASE 4.2
      07-18-17 by HPH - Removed 50 char. limit for !PACF! record (Incident Name)
      08-10-17 by HPH - Updating with changes for 6/17 version
      08-11-17 by HPH - Converted 16. to check boxes, removed "button" to show page 2 (no page 2)
                        fixed date errors in JS IDs
      08-11-17 by HPH - Modifications to some field sizes
      08-12-17 by HPH - Added ID line to the right at end of document.
      08-12-17 by MEF - Clean up HTML errors (missing closing tags, capitalization, etc.)
      08-14-17 by HPH - Update required list of form fields
      08-14-17 by MEF - Fix spelling errors, adjust field sizes for better printing
      09-15-17 by HPH - Fixed error on line 455 that should have been fradio and was not; I# 11 works (Poul Hansen found it)
      06-29-18 by MEF - Changed PacRelease from 4.3 to 4.4 ; Changed original form date from 06/17 to 08/17

    -->
    <style type="text/css">

        body {
            font-size: 9pt;
            font-weight: normal;
            color: black;
            font-family: Helvetica, Arial, sans-serif;
        }

        input, textarea, select {
            font-size: 9pt;
            font-weight: bold;
            background: #ffffdd;
            font-family: Consolas, "Lucida Console", "Lucida Sans Typewriter", Monaco, "Courier New", "monospace";
        }
        /* select { width: 300px; } */

        hr {
            color: black
        }

        table {
            font-size: 8pt;
            font-weight: bold;
        }

        .button1 {
            font-size: 8pt;
            font-weight: normal;
        }

        .nowrap {
            white-space: nowrap;
        }

        .banner-table {
            background: #DDDDDD;
        }

        .plan-intel-banner {
            background: #EEEEEE;
        }

        .logistics-banner {
            background: #FFCC33;
        }

        .fin-admin-banner {
            background: #FFFF99;
        }

        .msgno {
            font-size: 9pt;
            text-align: center;
        }

        .table1 {
            font-size: 9pt;
            font-weight: bold;
        }

        .table2 {
            font-size: 9pt;
            font-weight: normal;
        }

        .table3 {
            font-size: 11pt;
            font-weight: bold;
        }

        .table4 {
            font-size: 11pt;
            font-weight: normal;
        }

        .req-table {
            font-weight: bold;
        }

        .red {
            color: red;
        }

        .italic {
            font-style: italic;
            font-weight: normal;
            font-size: 8pt;
            color: black;
        }

        .city-button {
            font-size: 9pt;
        }

        .title-text {
            font-size: 12pt;
            font-weight: bold;
            color: blue;
        }

        .s1-title-text {
            font-size: 11pt;
            font-weight: bold;
        }

        .s2-title-text {
            font-size: 9pt;
            font-weight: normal;
        }

        .js-head-text {
            font-size: 9pt;
            font-weight: bold;
        }

        .js-error-text {
            font-size: 12pt;
            font-weight: bold;
            color: red;
        }

        .sm-text {
            font-size: 8pt;
        }

        .status-title {
            font-size: 12pt;
            font-weight: bold;
        }

        .oper-input {
            font-size: 8pt;
            font-weight: normal;
        }

        .submit-text {
            font-size: 10pt;
            color: red;
        }

        .form-ver-text {
            font-size: 8pt;
            font-weight: bold;
            text-decoration: underline;
        }

        .sec-title {
            font-size: 9pt;
            font-weight: bold;
            background-color: #DDDDDD;
        }

        .lineht {
            line-height: 240%;
        }

        #Page2 {
            display: none;
        }

        @media print {
            footer {
                page-break-after: always;
            }
        }
    </style>

    <!--
    >From this point, the JavaScript is common for all JS: forms (new method for pac-read)
    Where changes to a JavaScript function need to be made, a comment will be inserted there
      to describe what needs to be done.
    -->
    <style type="text/css" media="print">

        .header, .trailer {
            display: none;
        }

        .red {
            color: black;
        }

        .table4 {
            color: black;
        }

        hr {
            color: black
        }

        input, select, textarea {
            color: black;
            background: none;
        }

        .title-text {
            color: black;
        }

        .oper-input {
            color: black;
        }

        #show-hide-p2 {
            display: none;
        }

        #Page2 {
            display: block;
        }
    </style>

    <script language="JavaScript">
        // <!--

        // The first 2 records below are required.  They are part of the first 2 # records
        //  in the ASCII file sent to Outpost.
        //
        var JSid = "EOC Resource Request (which4)";
        var JSver = "JS-ver. PR-4.4-2.9, 06/29/18";
        var JShead = "<span class=\"js-head-text\">JavaScript Version PR-4.4-2.9 for Amateur Radio Packet Transmission, 06/29/18 - <b>PacRELEASE 4.4</b></span>";
        var JStail = "(PR-4.4-2.98, 06/29/18)";

        fromlocal = 0;  // =0 for call to pac-read with No !OUTPOST! record; >0 if so. Reset fm pac-read.

        var SHtoggle = 0;

        function ShowHide() {
            if (SHtoggle == 0) {
                document.getElementById("Page2").style.display = "block";
                SHtoggle = 1;
            }
            else {
                document.getElementById("Page2").style.display = "none";
                SHtoggle = 0;
            }
        }

        function lockUnlockMsg(checkbox) {
            if (checkbox.checked == 1) {
                document.getElementById('RSmsgno').disabled = false;
                document.getElementById('SRmsgno').disabled = false;
            }
            else {
                document.getElementById('RSmsgno').disabled = true;
                document.getElementById('SRmsgno').disabled = true;
            }
        }

        function emerg() {
        document.forms[0].handling[0].checked = true;
        }

        var whichway, ascii, thisurl;
        thisurl = "";
        function geturl() {
            if (thisurl != "") { return thisurl; }
            var res = new Array(), tem = new Array();
            var a = document.URL;
            tem = a.split(/\?/);
            //  alert(a+", T0:"+tem[0]+", T1:"+tem[1]);
            a = tem[0];
            a = a.replace(/\\/g, "\/");
            res = a.split(/\//g);
            var l = res.length - 1;
            //  alert(a+", "+l+", "+res[0]+","+res[l]);
            return res[l];
        }


        function resetforms() {
        document.forms[0].reset();
            document.forms[1].reset();
            datetime(0);  // added 4/17/10
        }

        function hide_message() {
            document.getElementById('errormessage1').style.display = 'none';
        }

        function Browser() {
            var bb = navigator.appName;
            if (bb.indexOf("Microsoft") != -1) {
                return true;
            }
            else {
                return false;
            }
        }

        function zerofill(val) {
            if (val > 9) { return "" + val }
            return "0" + val
        }

        function datetime(dum1)  // Parameter added 1/11/11 to update Operator send date/time
        {
            var hr, ampm;
            var Today = new Date();
            var month = zerofill(Today.getMonth() + 1);
            var year = Today.getFullYear();
            var day = zerofill(Today.getDate());
            var hr1 = Today.getHours();
            var min = zerofill(Today.getMinutes());
            /*                             // This section commented out may be useful to some forms.
                     if (hr1 >12)
                      { hr = hr1 - 12;
                        ampm = " PM";
                      } else
                      { hr = hr1;
                        ampm = " AM";
                      }
            */
            hr1 = zerofill(hr1);
            var dat = month + "/" + day + "/" + year;
            var tim = hr1 + ":" + min;
            var dtim = dat + " @ " + tim;
            /*
             The form field names Datt1 and Timm1 may need to be changed to be compatible with
              the form field names that you will use in your form to auto load the date and
              time in your form when the form is initially loaded.
            */
            if (dum1 == 0)     // datetime(0) is called at form load
            {
            document.forms[0].date3.value = dat;
                document.forms[0].time3.value = tim;
                document.forms[0].odate.value = dat;
                document.forms[0].otime.value = tim;
            } else
                if (dum1 == 1)     // datetime(1) is called to update values when the form is submitted
                {
                document.forms[0].date3.value = dat;
                    document.forms[0].time3.value = tim;
                    document.forms[0].odate.value = dat;
                    document.forms[0].otime.value = tim;
                } else
                    if (dum1 == 2)   // datetime(2) is called if testvalues fails (not all required fields are filled)
                    { // document.forms[0].Datt1.value="";
                        // document.forms[0].Timm1.value="";
                    }

        }

        function trim(strval)              // Trims leading and trailing blanks
        {                                  // [ ]  changed to (( & )) " changed to '
            strval = strval.replace(/\`\]/g, "\x87")  // New - temp.
            strval = strval.replace(/\]/g, "`]");     // New
            strval = strval.replace(/\x87/g, "``]");  // New
            strval = strval.replace(/\s*$/, "");
            strval = strval.replace(/^\s*/, "");
            strval = strval.replace(/\"/g, "\'");
            strval = strval.replace(/\`$/, "` ");  // adds a last backtick with backtick blank
            return strval;
        }

        function wrap(inStr, cols) {
            var i, n, itot, str, res, cvt;
            words = new Array;
            if (inStr == "") { return inStr; }
            if (cols < 0) {
                cols = Math.abs(cols);
                //       inStr = inStr.replace(/%BF/g, "%37BF");  // removes %BF typed by user NEW
                //       inStr = inStr.replace(/\n/g,"\xBF");   // Inverted ?
                inStr = inStr.replace(/\n/g, "\\n");      //NEW
                inStr = inStr.replace(/\r/g, "");
                //       inStr = "\xBF"+inStr;                  // Inverted ?
                inStr = "\\n" + inStr;                    // NEW
            } else {
                inStr = inStr.replace(/\n|\r/g, " ");
            }
            words = inStr.split(" ");
            iwd = words.length;
            n = inStr.length;
            i = 0;
            k = 0;
            res = "";
            blk = "";
            itot = 0;
            for (i = 0; i < iwd; i++) {
                if (itot >= cols) {
                words[i] = words[i] + "\n";
                    itot = 0;
                }
                itot = itot + words[i].length + 1;
                res = res + blk + words[i];
                blk = " ";
            }
            return res;
        }

        var itot;
        function unwrap(str, msg) {
            var i, n, nl, iwd, k;
            words = new Array;
            icols = msg.cols;
            irows = msg.rows;
            str = str.replace(/\xBF/g, "\\n");  // Converts all inverted ? to \n from old versions, 7/23/13
            str = str.replace(/\\n/g, "\n");
            if (str.charAt(0) == "\n")      // Removes inverted \n at 1st Chr.
            { str = str.substring(1); }
            parl = countlines(str);
            tsl = str.length;
            nrows = Math.ceil(tsl / icols);
            words = str.split(" ");
            iwd = words.length;
            n = str.length;
            //    if (n <= icols) { return inStr }
            i = 0;
            k = 0;
            nl = 0;
            res = "";
            itot = 0;
            for (i = 0; i < iwd; i++) {
                if (itot >= icols) {
                    nl++;
                    itot = 0;
                }
                itot = itot + words[i].length + 1;
            }
            itot = nl + parl + 1;
            if (nrows > itot) { itot = nrows; }
            //  alert(nl+" "+parl+" "+irows+" "+icols+" "+nrows )
            str = str.replace(/\n/g, "\r\n");
            if (itot > irows) { msg.rows = itot; }
            return str;
        }

        function countlines(inStr) {
            var i, n, m;
            n = 0;
            i = 0;
            m = inStr.indexOf("\n", n);
            while (m >= 0) {
                i++;
                n = m + 1;
                m = inStr.indexOf("\n", n);
            }
            return i;
        }

        sepChar = String.fromCharCode(167);
        instr = "";

        function out(win, text, param) {
            var str, val;
            if (param == "") { return; }
            str = text + ": [" + param + "]\n";
            if (whichway == 0) {
                win.document.write(str);
            } else {
                ascii += str;
            }
        }

        function radio(win, param, text, max) {
            var i, val, j;
            j = 0;
            for (i = 0; i < max; i++) {
                if (param[i].checked) {
                    val = param[i].value;
                    out(win, text, val);
                    j = 1;
                }
            }
            if (j == 0) { out(win, text, "") }
        }

        function fradio(param, max) {
            var i, val, j;
            j = 0;
            for (i = 0; i < max; i++) {
                if (param[i].checked) {
                    val = param[i].value;
                    j = 1;
                }
            }
            if (j == 0) { val = ""; }
            return val;
        }

        function fdropdown(param) {
            var indx, val;
            indx = param.selectedIndex;
            val = param.options[indx].value;
            return val;
        }
        /*
         This function tests to make sure that required fields are filled in properly.
         My mehtod is to take a form field name like msgno and create a variable called Fmsgno.
         See function newwin below, where the F<names> are defined.
         */

        function testvalues() {
            var str;
            str = "";
            if (Fmsgno == "") { str = "Enter a Message Number."; }
            if (Fsever == "") { str = str + "\n Indicate Situation Severity."; }
            if (Fhandling == "") { str = str + "\n Indicate Msg. Handling Order."; }
            if (FIncName == "") { str = str + "\n Enter the Incident Name."; }
            if (Fdate3 == "") { str = str + "\n Enter the Date Initialized."; }
            if (Ftime3 == "") { str = str + "\n Enter the Time Initialized."; }
            if (FReqBy5 == "") { str = str + "\n Enter 5. Requested By."; }
            if (FQuan1 == "") { str = str + "\n Enter 8. Qty/Unit."; }
            if (FDescrip1 == "") { str = str + "\n Enter 9. Resource Description."; }
            if (FDtTim1 == "") { str = str + "\n Enter 10. Arrival Date/Time."; }
            if (FPri == "") { str = str + "\n Select 11. Priority."; }
            if (FTarea13 == "") { str = str + "\n Enter 13. Delivery to."; }
            if (FTarea14 == "") { str = str + "\n Enter 14. Location."; }

            if (str == "") {
                return true;
            } else { // datetime(2);
                alert(str);
                return false;
            }
        }

        function checkbox(param) {
            if (param) {
                return "checked";
            } else {
                return "";
            }
        }

        function gatherdata() {
            document.forms[1].formtext.value = ascii;
            return;
        }

        function poundstuff() {
            var reqStr = "!PACF! " + pacf + "\n" + "# JS:" + JSid + "\n" + "# " + JSver + "\n" +
                "# FORMFILENAME: " + geturl() + "\n";
            //   "# Form Item numbers are followed by a colon (:)\n"+
            //   "# Answers are enclosed in brackets ( [ ] )\n"+
            //   "# Note: The symbol "+"\xBF"+" is NOT a bug. It is used in Textarea formatting.\n";
            return reqStr;
        }

        var pacf = "";
        function newwin(theway) {
            datetime(1);
            whichway = theway;

            // Required form fields are defined here and are tested in testvalues
            // variable to the left of = is the same as the form field name with F added at the beginning.
            Fmsgno = trim(document.forms[0].msgno.value); // TEXT
            Fsever = fradio(document.forms[0].sever, 3);
            Fhandling = fradio(document.forms[0].handling, 3);
            FIncName = trim(document.forms[0].IncName.value);
            Fdate3 = trim(document.forms[0].date3.value);
            Ftime3 = trim(document.forms[0].time3.value);
            FReqBy5 = trim(document.forms[0].ReqBy5.value);
            FQuan1 = trim(document.forms[0].Quan1.value);
            FDescrip1 = trim(document.forms[0].Descrip1.value);
            FDtTim1 = trim(document.forms[0].DtTim1.value);
            FPri = fradio(document.forms[0].Pri, 4);
            FTarea13 = trim(document.forms[0].Tarea13.value);
            FTarea14 = trim(document.forms[0].Tarea14.value);

            /*
              Next 5 lines are for added info after the !PACF! record sent to Outpost
              The variable pacf, below, is composed of several components a, b, c & d
              variable d usually describes the form
            */
            d = "EOC213RR";  // Modified as per MMEF, 4-4-17
            a = Fmsgno.substring(0);
            b = Fsever.substring(0, 1);
            c = Fhandling.substring(0, 1);
            pacf = a + "_" + b + "/" + c + "_" + d + "_" + FIncName;
            //
            if (whichway == 1) {
                ascii = poundstuff();
                NewWin = 0;
            } else {
                if (!testvalues()) { return; }

                NewWin = window.open("", null, "height=600,width=700,status=yes,toolbar=yes,menubar=yes,location=no,scrollbars=yes,resizable=yes");
                NewWin.document.write("<" + "html>\n");
                NewWin.document.write("<" + "head>\n");
                NewWin.document.write("<title>EOC Logistics Request</title>\n");
                var bbb = Browser();
                if (bbb) {
                    NewWin.document.write('<S' + 'CRIPT LANGUAGE="JavaScript" type="text/javascript">\n');

                    NewWin.document.write("function ClipBoard()\n");
                    NewWin.document.write(" { \n");
                    NewWin.document.write("   holdtext.innerText = copytext.innerText; \n");
                    NewWin.document.write("   Copied = holdtext.createTextRange(); \n");
                    NewWin.document.write('   Copied.execCommand("Copy"); \n');
                    NewWin.document.write(" } \n");

                    NewWin.document.write("</S" + "CRIPT> \n");
                }
                NewWin.document.write("<" + "/head> \n");
                if (bbb) {
                    NewWin.document.write('<' + 'body  bgcolor="#ffffff" onLoad="ClipBoard()">\n');
                    NewWin.document.write('<SPAN ID="copytext" STYLE="background-color:lightblue">\n');
                    NewWin.document.write('<TEXTAREA ID="holdtext" STYLE="display:none;"> </TEXTAREA>\n');
                }
                else {
                    NewWin.document.write('<' + 'body>\n');
                }
                NewWin.document.write("<pre>\n");
                NewWin.document.write("!PACF! " + pacf + "\n# JS:" + JSid + "\n");
                NewWin.document.write("# " + JSver + "\n");
                NewWin.document.write("# FORMFILENAME: " + geturl() + "\n");
                /*
                 if (bbb)
                  { NewWin.document.write('<span class="red"># \n');
                    NewWin.document.write("# THE LIGHT BLUE HIGHLIGHTED TEXT HAS BEEN AUTOMATICALLY COPIED \n");
                    NewWin.document.write("# to the Clipboard.  To save it to a file, you must \n");
                  }
                 else
                  { NewWin.document.write('<span class="red"># TO COPY THE TEXT IN THIS WINDOW, FOCUS THIS WINDOW, THEN:\n');
                    NewWin.document.write("# Select All ASCII Text by typing Ctrl-A, then Ctrl-C to Copy.\n");
                  }
                 NewWin.document.write("# Next, RUN WordPad or Notepad and DO Ctrl-V to Paste into the editor body.\n");
                 NewWin.document.write("# Then DO Save-As to a TEXT Document file, or Paste directly into Outpost.</span>\n");
                 NewWin.document.write("# Form Item numbers are followed by a colon (:)\n");
                 NewWin.document.write("# Answers are enclosed in brackets ( [ ] )\n");
                */
            }  // end of else loop where whichway == 0
            //
            listels();

            if (whichway == 0) {
                NewWin.document.write("#EOF\n");
            } else {
                ascii += "#EOF\n";
                gatherdata();
                return;
            }
            //
            NewWin.document.write("</pre>\n");
            if (bbb) { NewWin.document.write("</SPAN>"); }
            NewWin.document.write("</body>");
            NewWin.document.write("</html>");
            NewWin.document.close();
        }
        //
        var qsParm = new Array();
        var qsVal = new Array();
        var qsN;
        function qs() {
            var n = 0;
            var query = window.location.search.substring(1);
            query = query.replace(/%20/g, "");
            var leng = query.length;
            // alert("Query="+query+", "+leng);
            if (leng <= 1) { return; }
            var parms = query.split('&');
            qsN = parms.length;
            for (var i = 0; i < qsN; i++) {
                var pos = parms[i].indexOf('=');
                if (pos > 0) {
                    qsParm[i] = parms[i].substring(0, pos);
                    qsVal[i] = parms[i].substring(pos + 1);
                    qsVal[i] = decodeURI(qsVal[i]);
                    qsVal[i] = qsVal[i].replace(/\+/g, " ");
                }
            }
            assignq();
        }

        function assignq() {
            var i, j, dum;
            for (i = 0; i < qsN; i++) {
                if (!document.forms[0][qsParm[i]]) {
                    alert(">>> Form Field name \'" + qsParm[i] + "\' does NOT exist.");
                } else {
                document.forms[0][qsParm[i]].value = qsVal[i];
                }
            }
        }
        /*
            var rtoggle = 0;
            function RSwitch()
             { var em;
               if (rtoggle == 0)
                { document.getElementById("rnorm").style.display="none";
                  document.getElementById("rdrop").style.display="block";
                  document.forms[0].b1.value="Display Manual Entry";
                  document.forms[0].citylist[0].selected=true;
                  em=document.getElementById("email1").value;
                  if (em != "")
                   { document.getElementById("email2").value=em;
                   }
                  rtoggle = 1;
                }
               else
                { document.getElementById("rnorm").style.display="block";
                  document.getElementById("rdrop").style.display="none";
                  document.forms[0].b1.value="Display List of Cities";
                  em=document.getElementById("email2").value;
                  if (em != "")
                   { document.getElementById("email1").value=em;
                   }
                  rtoggle = 0;
                }
               return false;
             }

            function rbacktonorm()
             { var dum=document.forms[0].citylist.value;
                   document.forms[0].reqest.value=dum;
                   document.forms[0].b1.value="Display Manual Entry"
                   RSwitch();
             }
        */
        var ttoggle = 0;
        var ftoggle = 0;

        function custom() {
            var i, num;
            //writeels(); // Uncomment when you want to check all elements
            qs(); // Do Not remove this function call. Used by Outpost to pass data.
            num = document.forms[0].msgno.value;
            if (num == "$$") { writeels(); }

        } //End Custom

        function testreply() {
            if (fromlocal > 0) {
                document.getElementById("senddt").style.display = "none";
                document.getElementById("outpostdt").style.display = "block";
            }
            return;
        }

        //  Displays all form field values as a disagnostice tool
        function writeels() {
            var n, typ, val, nam, str, lb, i;

            n = document.forms[0].elements.length;
            javascript: void (window.open());
            Ele = window.open("", null, "height=600,width=700,status=yes,toolbar=yes,menubar=yes,location=no,scrollbars=yes,resizable=yes");
            Ele.document.write("<" + "html>\n" + "<head>\n<title>Element List</title>\n</head>\n");
            Ele.document.write("<" + "body>\n<b>ELEMENT LIST for " + geturl() + "<p>Ele. Index, Type, Name, Value</b><p>");
            for (i = 0; i < n; i++) { //lb = String.fromCharCode(163); // English pound sign - to flag select index
                lb = "}";
                typ = document.forms[0].elements[i].type;
                nam = document.forms[0].elements[i].name;
                val = document.forms[0].elements[i].value;
                str = i + ",  " + typ + ", &nbsp; " + nam + ",  &nbsp; " + val + ", &nbsp; ";
                if (typ == "radio" || typ == "checkbox") {
                    chk = document.forms[0].elements[i].checked;
                    str = str + "[" + chk + "], ";
                }
                if (typ == "select-one") {
                    indx = document.forms[0].elements[i].selectedIndex;
                    str = str + lb + indx;
                }
                str = str + ",<br>";
                Ele.document.write(str);
            }
            Ele.document.write("</body>\n</html>\n");
            Ele.document.close();
        }

        var inl = new Array();
        var inr = new Array();

        function outels()   //  Used to fill form fields by pac-read
        {
            var inn, typ, val, indx, nam, chk, nidx, k, lb;
            var dum = new Array();
            lbo = String.fromCharCode(163);
            lb = "}";
            inn = inl.length;
            // alert(inn+" "+inl[0]+" "+ inl[1]);
            for (i = 0; i < inn; i++) {
                k = inl[i];
                typ = document.forms[0].elements[k].type;
                nam = document.forms[0].elements[k].name;
                if (typ == "radio" || typ == "checkbox") {
                document.forms[0].elements[k].checked = inr[i];
                } else if (typ == "text" || typ == "hidden") {
                document.forms[0].elements[k].value = inr[i];
                } else if (typ == "textarea") {
                    ms2 = unwrap(inr[i], document.forms[0].elements[k]);
                    document.forms[0].elements[k].value = ms2;
                } else if (typ == "select-one") {
                    if (inr[i].indexOf(lbo) > -1) { lb = lbo; }
                    dum = inr[i].split(lb);
                    indx = dum[1];
                    document.forms[0].elements[k].selectedIndex = indx;
                }
            }
            testreply();
        }

        function listels()  //  Writes ASCII file when  form is submitted to send to pac-read.
        {
            var n, typ, val, indx, nam, chk, nidx, k, lb;
            n = document.forms[0].elements.length;
            // lb = String.fromCharCode(163); // English pound sign - to flag select index
            lb = "}";
            //  yen = String.fromCharCode(165); // Yen sign to flag odate or otime parameter
            yen = "{";
            for (i = 0; i < n; i++) {
                typ = document.forms[0].elements[i].type;
                nam = document.forms[0].elements[i].name;
                if (typ == "radio" || typ == "checkbox") {
                    chk = document.forms[0].elements[i].checked;
                    out(NewWin, i, chk);
                    //            test=chk+" "+typ+" "+nam;
                    //            out(NewWin,i,test);
                } else if (typ == "button") {
                    continue;       // Button will not show in Ascii file.
                } else {
                    val = document.forms[0].elements[i].value;
                    if (typ == "text" || typ == "textarea" || typ == "hidden") {
                        val = trim(val);
                        if (nam == "odate" || nam == "otime") {
                            val = val + yen + nam;
                        }
                    }
                    if (typ == "textarea") {
                        val = wrap(val, -50);
                    }
                    if (typ == "select-one") {
                        indx = document.forms[0].elements[i].selectedIndex;
                        val = val + lb + indx;
                    }
                    out(NewWin, i, val);
                }
            }
            if (document.forms[0].msgno.value == "$$") { writeels(); }
        }

    </script>
    <script src="js/AddedForWebView.js"></script>

    <!-- PART1 -->
</head>
<body onload="hide_message(); datetime(0); custom();" bgcolor="#ffffff">
<!-- PART2 -->
<center>
<table class="banner-table" width="100%">
  <tbody><tr><td><center>
    <span class="title-text">County of Santa Clara Emergency Operations Center<br>
    RESOURCE REQUEST FORM (EOC FORM 213RR)</span>
    <div class="js-head-text header">
      <script language="JavaScript"> // put in header area
        document.write(JShead);
      </script><br>
      <span class="s2-title-text">(For the manual saving of the ASCII output, this form is best used with Microsoft Internet Explorer)</span>
      <div id="errormessage1" name="errormessage1" align="center">
        <p>&nbsp;</p>
        <hr size="3" color="red">
        <span class="js-error-text">
        JAVASCRIPT IS NOT ENABLED IN THIS BROWSER.<br>
        THIS FORM WILL NOT WORK WITHOUT JAVASCRIPT ENABLED.</span>
        <hr size="3" color="red">
        <p>&nbsp;</p>
      </div>
    </div>
  </center></td></tr>
</tbody></table>

<span class="header">
<!-- PART3 -->

</span>
<form name="theForm">
<center>

<span class="red header"><b>Items in RED <i>Italics</i> and marked with * are Required</b></span>
<!-- Message Numbers -->
<table class="msgno" width="100%">
  <tbody><tr>
    <td nowrap="nowrap" align="right">A.) When Receiving, &nbsp;<br>Sender's Msg. No. &nbsp;</td>
    <td nowrap="nowrap" align="left"><input size="11" name="RSmsgno" tabindex="1" id="RSmsgno" disabled="true" type="text"></td>
    <td nowrap="nowrap" align="right"><span class="red"><b>B.) Message &nbsp;<br>Number &nbsp;</b></span></td>
    <td nowrap="nowrap" align="left"><input size="11" name="msgno" tabindex="2" type="text"></td>
    <td nowrap="nowrap" align="right">&nbsp;C.) When Sending, &nbsp;<br>Receiver's Msg. No. &nbsp;</td>
    <td nowrap="nowrap" align="left"><input size="11" name="SRmsgno" tabindex="3" id="SRmsgno" disabled="true" type="text"></td>
  </tr>
</tbody></table>

<div class="header">
  <span style="font-size:8pt">
    <input name="unlockmsg1" value="1" onclick="lockUnlockMsg(this)" type="checkbox">Unlock msg. nos. A.) &amp; C.)
  </span>
</div>

<!-- Severity, Handling Order, Reply -->
<!--<center>-->
<table class="table1" width="100%" border="1">
<!---
<tr class="header">
-->
  <tbody><tr valign="top">
    <td nowrap="nowrap">
      <span class="red"><b>D.) Situation Severity </b></span><span class="header">(Select One)</span><br>
      <input name="sever" value="EMERGENCY" tabindex="6" onclick="emerg()" type="radio">
        <b>EMERGENCY</b>&nbsp;<span class="sm-text">(e.g., Life Threat)</span><br>
      <input name="sever" value="URGENT" tabindex="7" type="radio">
        <b>URGENT</b>&nbsp;<span class="sm-text">(e.g., Property Threat)</span><br>
      <input name="sever" value="OTHER" tabindex="8" type="radio">
        <b>OTHER</b>&nbsp;<span class="sm-text">(All Others)</span><br>
    </td>
    <td nowrap="nowrap">
      <span class="red"><b>E.) Msg. Handling Order </b></span><span class="header">(Select One)</span><br>
      <input name="handling" value="IMMEDIATE" tabindex="9" type="radio">
        <b>IMMEDIATE</b>&nbsp;<span class="sm-text">(As Soon as Possible)</span><br>
      <input name="handling" value="PRIORITY" tabindex="10" type="radio">
        <b>PRIORITY</b>&nbsp;<span class="sm-text">(Less Than One Hour)</span><br>
      <input name="handling" value="ROUTINE" tabindex="11" type="radio">
        <b>ROUTINE</b>&nbsp;<span class="sm-text">(More Than One Hour)</span><br>
    </td>
    <td nowrap="nowrap"><b>F.) Message Requests You to:<br><br>
      &nbsp;&nbsp;REPLY</b> (Check one)<br>
      <input name="replyyn" value="Yes" tabindex="14" type="radio"><b>Yes, by</b>
      <input name="replyby" size="17" tabindex="15" type="text">&nbsp;
      <input name="replyyn" value="No" tabindex="16" type="radio"><b>No&nbsp;</b>
    </td>
  </tr>
</tbody></table>


<center>
<!--  End of common header information, Beginning of basic form -->
<table class="table1" width="100%" border="1">
  <tbody><tr valign="top" align="left">
    <td class="red" width="35%">1. Incident Name<br>
         <textarea name="IncName" rows="2" cols="50"></textarea></td>
    <td class="red" width="20%">2. Date Initiated<span class="nowrap"><br> <input name="date3" size="12" value="08/14/2017" type="text"></span></td>
    <td class="red" width="20%">3. Time Initiated<span class="nowrap"><br> <input name="time3" size="10" value="19:52" type="text"></span></td>
    <td width="25%" bgcolor="#EEEEEE">4. Tracking Number<br><span class="italic">(Completed by OA EOC)</span></td>
  </tr>

  <tr>
    <td width="35%"><span class="red">5.Requested By </span><span class="italic">(Name, agency, position, email, phone)</span>
      <table>
        <tbody><tr><td><textarea name="ReqBy5" cols="50" rows="5"></textarea></td></tr>
      </tbody></table>
      <hr width="100%">
       6. Prepared by <span class="italic">(Name, position, email, phone)</span>
      <table>
        <tbody><tr><td><textarea name="PrepBy6" cols="50" rows="4"></textarea></td></tr>
      </tbody></table>
      <hr width="100%">
       7. Approved by <span class="italic">(Name, position, email, phone)</span>
	    <table>
	      <tbody><tr><td><textarea name="ApprovBy7" cols="50" rows="4"></textarea></td></tr>
	    </tbody></table>
    </td>

    <td colspan="3" width="65%" valign="top">
      <table class="table2">
        <tr>
          <td width="12%">&nbsp;</td>
          <td><b><u>How to use the EOC Form 213RR</u></b></td>
        </tr>
        <tr>
          <td valign="top" nowrap="nowrap"><b>Purpose: </b>&nbsp;</td>
          <td valign="top">The EOC 213RR is used to request non-mutual aid supplies, services, personnel, teams,
            equipment, utilities, fuel, facilities, or any other resource or incident management activity required
            from the Operational Area (OA.)</td>
        </tr>

        <tr>
          <td valign="top" nowrap="nowrap"><b>When to use: </b></td>
          <td valign="top">The Form 213RR may be used anytime during any Operational Period. If the OA EOC is
            not activated the Duty Officer will serve to coordinate the request.</td>
        </tr>
        <tr>
          <td valign="top" nowrap="nowrap"><b>Prepared by: </b></td>
          <td valign="top">Any EOC position or agency requesting resources from the OA EOC.</td>
        </tr>
        <tr>
          <td valign="top" nowrap="nowrap"><b>Approved by: </b></td>
          <td>Section Chief of the requesting EOC or Supervising Official at Requesting Agency</td>
        </tr>
        <tr>
          <td valign="top" nowrap="nowrap"><b>Routed to: </b></td>
          <td valign="top">Planning Section Resource Status Unit-&gt;Logistics Section -&gt; Finance/Admin
            Section -&gt; EOC Director -&gt; Planning -&gt; Intelligence Section</td>
        </tr>
        <tr>
          <td valign="top" nowrap="nowrap"><b>Filed with: </b></td>
          <td valign="top">Planning Section Documentation Unit.</td>
        </tr>
        <tr>
          <td valign="top" nowrap="nowrap"><b>User Notes: </b></td>
          <td valign="top">The Form 213RR is a two-sided form. Side one is completed by the requestor. &nbsp; Side
            two is completed by the OA EOC.<br>
            <b>Please check that both sides are available.</b></td>
        </tr>
      </table>
    </td>
  </tr>
</tbody></table>

<span class="s1-title-text">Requesting Agency / EOC Section<br>REQUESTED SOURCE DETAILS</span>

<table width="100%" border="1">
  <tbody><tr class="s2-title-text" align="center">
    <td class="red"><b>8. Qty/Unit</b></td>
    <td class="red"><b>9. Resource Description</b>
      <span class="italic">(Kind/Type. if applicable)</span></td>
    <td class="red"><b>10. Arrival</b> <span class="italic">(date/time)</span></td>
    <td class="red"><b>11. Priority</b></td>
    <td><b>12. Est'd Cost</b></td>
  </tr>
  <tr align="left">
    <td><textarea name="Quan1" rows="6" cols="10"></textarea></td>
    <td><textarea name="Descrip1" cols="60" rows="6" wrap="soft"></textarea></td>
    <td><textarea name="DtTim1" rows="6" cols="20"></textarea></td>
    <td class="nowrap">
      <table>
       <tbody><tr><td>Now </td><td>         <input name="Pri" value="Now" type="radio"></td></tr>
       <tr><td>High (0-4 hrs.)</td><td>     <input name="Pri" value="High" type="radio"></td></tr>
       <tr><td>Medium (5-12 hrs.) </td><td> <input name="Pri" value="Medium" type="radio"></td></tr>
       <tr><td>Low (12+hrs.) </td><td>      <input name="Pri" value="Low" type="radio"></td></tr>
      </tbody></table>
    </td>
    <td><textarea name="Cost1" rows="6" cols="12"></textarea></td>
  </tr>
</tbody></table>

<table class="table1" width="100%" border="1">
  <tbody><tr><td align="left"><span class="red">13. Delivery to</span><span class="italic">
       (name, agency, position, email, phone)</span><br>
       <textarea name="Tarea13" rows="6" cols="60" wrap="soft"></textarea></td>
      <td><span class="red"> 14. Location </span><span class="italic">(address or Lat/long., site type)</span><br>
      <textarea name="Tarea14" rows="6" cols="60" wrap="soft"></textarea></td>
  </tr>

  <tr><td colspan="2" align="left">15. Suitable Substitutes / Suggested Sources
       <span class="italic">(name, source, website)</span><br>
       <textarea name="Tarea15" rows="4" cols="100" wrap="soft"></textarea></td>
  </tr>

  <tr>
    <td align="left">16. Supplement Requirements <span class="italic">(Include details in #17)</span>
      <table>
        <tbody><tr>
          <td><input name="SupReq1" value="equip. operator" type="checkbox"> Equipment Operator</td>
          <td><input name="SupReq2" value="Lodging" type="checkbox"> Lodging</td></tr>
        <tr>
          <td><input name="SupReq3" value="Fuel" type="checkbox"> Fuel &nbsp; &gt;&gt;type
              <input name="ftype" size="20" type="text"></td>
          <td><input name="SupReq4" value="Power" type="checkbox">Power</td></tr>
        <tr>
          <td><input name="SupReq5" value="meals" type="checkbox"> Meals</td>
	        <td><input name="SupReq6" value="maint" type="checkbox"> Maintenance</td></tr>
        <tr>
          <td><input name="SupReq7" value="water" type="checkbox"> Water</td>
	        <td><input name="SupReq8" value="Other" type="checkbox"> Other <span class="italic">(put details in #17)</span></td></tr>
      </tbody></table></td>
    <td align="left">17. Special Instructions<br>
         <textarea name="Special17" rows="7" cols="65"></textarea></td>
  </tr>
</tbody></table>

<!-- Operator Area -->
<table class="table2" border="1">
  <tbody><tr>
    <td valign="middle" nowrap="nowrap">
      <input name="recsent" value="Received" type="radio">Rcv'd&nbsp;
      <input name="recsent" value="Sent" checked="checked" type="radio">Sent&nbsp;</td>
    <td valign="middle" nowrap="nowrap">
      <input name="method" value="Voice" type="radio">Voice&nbsp;
      <input name="method" value="Packet" checked="checked" type="radio">Packet&nbsp;</td>
    <td valign="middle" nowrap="nowrap">
      &nbsp;Call <input name="ocall" size="9" class="oper-input" type="text">
      &nbsp;Name <input name="oname" size="25" class="oper-input" type="text"></td>
    <!-- Outpost State, Date, Time -->
    <td valign="middle" nowrap="nowrap">
      <span id="senddt" style="display:block;">
        &nbsp;Submitted <input name="odate" size="11" disabled="disabled" class="oper-input" value="08/14/2017" type="text">
        <input name="otime" size="6" disabled="disabled" class="oper-input" value="19:52" type="text">
      </span>
      <!-- Need to handle the third option:  "Sent" -->
      <span id="outpostdt" style="display:none;">
        &nbsp;Received <input name="ordate" size="11" disabled="disabled" class="oper-input" type="text">
        <input name="ortime" size="6" disabled="disabled" class="oper-input" type="text">
      </span>
    </td>
  <!--
    <td>
      <input type="button" id="show-hide-p2" onClick="ShowHide();" class="button1" value="Display/Hide Page 2">
    </td>
  -->
  </tr>
</tbody></table>

<!-- <footer> -->
  <span class="js-head-text">Paper Form: Last Revised 6/17 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; EOC Form 213RR
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Page 1 of 2 (pg. 2 at EOC)<br></span>
    <p>
 <!-- Form Version Information -->
 </p><div class="form-ver-text" align="right">
   SCCo EOC Resource Request 213RR 08/17
   <script type="text/javascript">
     document.write(JStail);
   </script>
  </div>
<!-- </footer> -->

</center>


<!--  Addition for saving to Outpost -->
</form>

<!-- PART3.1 -->
<center>
<div class="trailer">
<form name="submitmachine" method="post" action="http://127.0.0.1:9334/send" onsubmit="return testvalues()">

<table width="70%">
  <tbody><tr><td><span class="submit-text">
    <p>Below you will see two SUBMIT buttons.  The one on the left, when Submitted, will
    open a new window with the ASCII text so you can manually capture, copy, paste and
    save the text.  Follow instructions in red in that window.</p>
    <p>The SUBMIT button to the right will automatically transfer the ASCII text extracted
    from the form to the Outpost database via via OpDirect.
    OpDirect must be running to make this work or nothing is saved.</p></span></td></tr>
</tbody></table>

<input value="SUBMIT the Form: Manual Copy &amp; Save" onclick="newwin(0)" type="button">
<input name="formtext" value="snafutextnotchanged" type="hidden">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
<input value="SUBMIT the Form to Outpost" onclick="newwin(1)" type="submit">
&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
<input value="Clear Input" onclick="resetforms();" type="reset">

</form>
</div>
</center>
</body>
</html>
<!-- PART4 -->